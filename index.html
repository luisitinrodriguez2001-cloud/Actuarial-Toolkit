<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Fitness-Toolkit</title>
  <link rel="stylesheet" href="./style.css">

</head>
<body>
<!-- partial:index.partial.html -->
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <title>Fitness Toolkit</title>

  <!-- Inter font (clean UI) -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />

  <!-- Tailwind CDN (keeps all your utility classes working) -->
  <script>
    window.tailwind = window.tailwind || {};
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'ui-sans-serif', 'system-ui'] },
          keyframes: {
            fadeUp: { '0%': {opacity:0, transform:'translateY(8px) scale(.98)'}, '100%': {opacity:1, transform:'translateY(0) scale(1)'} },
            shimmer: { '0%': {backgroundPosition:'-468px 0'}, '100%': {backgroundPosition:'468px 0'} },
            floaty: { '0%': { transform:'translateY(0px)'}, '50%': { transform:'translateY(-8px)'}, '100%': { transform:'translateY(0px)'} }
          },
          animation: {
            fadeUp: 'fadeUp .4s cubic-bezier(.2,.8,.2,1) both',
            floaty: 'floaty 6s ease-in-out infinite',
          },
          boxShadow: {
            card: '0 8px 24px rgba(2, 6, 23, .06)'
          }
        }
      }
    }
  </script>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Your custom layer (tooltip, inputs, micro-interactions, extra motion) -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="bg-slate-50 text-slate-900 antialiased">
  <!-- Ambient background blobs (pure CSS, subtle motion) -->
  <div class="pointer-events-none fixed inset-0 overflow-hidden" aria-hidden="true">
    <div class="absolute -top-24 -left-24 w-72 h-72 rounded-full bg-gradient-to-br from-amber-200 to-pink-200 blur-3xl opacity-60 animate-floaty"></div>
    <div class="absolute -bottom-24 -right-24 w-80 h-80 rounded-full bg-gradient-to-br from-emerald-200 to-sky-200 blur-3xl opacity-60 animate-floaty" style="animation-delay: -2.2s;"></div>
  </div>

  <main class="relative">
    <div id="root"></div>

    <section id="longevity-lab" class="card" aria-labelledby="longevity-title">
      <h2 id="longevity-title">Counterfactual Longevity Lab</h2>

      <!-- Global disclaimer banner -->
      <p class="disclaimer" role="note">
        Population-level estimates only. Uses U.S. period life table + published hazard ratio associations.
        Not medical advice. Results are sensitive to assumptions. See “Assumptions & Data Sources.”
      </p>

      <!-- Controls + Summary -->
      <div class="grid two-col" id="controls">
        <div>
          <fieldset aria-describedby="disclaimer-controls">
            <legend>Profile</legend>
            <label>Age
              <input id="age" type="number" min="20" max="100" inputmode="numeric" placeholder="35" />
            </label>
            <label>Sex
              <select id="sex">
                <option value="F">Female</option>
                <option value="M">Male</option>
              </select>
            </label>
          </fieldset>

          <fieldset>
            <legend>Behaviors</legend>

            <label>Smoking
              <select id="smoking">
                <option value="never">Never</option>
                <option value="current">Current</option>
                <option value="former">Former</option>
              </select>
            </label>
            <label id="ysq-wrap" class="inline" hidden>
              Years since quit
              <input id="yearsSinceQuit" type="number" min="0" max="60" placeholder="5" />
            </label>

            <label>Physical activity (MET-hours/week)
              <input id="metHours" type="number" min="0" max="100" step="0.5" placeholder="10" />
            </label>

            <label>BMI
              <input id="bmi" type="number" min="10" max="60" step="0.1" placeholder="27.5" />
            </label>

            <label>Alcohol (drinks/day)
              <input id="alcohol" type="number" min="0" max="10" step="0.1" placeholder="0" />
            </label>

            <small class="disclaimer">
              Associations, not causation. Hazard ratios drawn from large cohort/meta analyses; simplifications apply.
            </small>
          </fieldset>

          <fieldset>
            <legend>Preventive screening</legend>
            <label><input type="checkbox" id="crc_screen" checked /> Colorectal: guideline schedule (45–75)</label>
            <label><input type="checkbox" id="breast_screen" /> Breast: biennial from 40–74</label>
            <small class="disclaimer">Modeled as additive life-years/QALYs from published decision analyses.</small>
          </fieldset>

          <label class="inline">
            <input id="qualityToggle" type="checkbox" />
            Show quality-adjusted years (HALE/QALYs)
          </label>

          <div class="actions">
            <button id="runBtn" class="primary">Recalculate</button>
            <button id="assumptionsBtn" type="button">Assumptions & Data Sources</button>
          </div>
          <small id="disclaimer-controls" class="disclaimer">
            This tool uses a period life table (mortality held constant at observed year), proportional-hazards scaling,
            and screening deltas from external models. It is not personalized medical guidance.
          </small>
        </div>

        <!-- Results summary -->
        <div id="summary" aria-live="polite">
          <div class="stat">
            <div class="stat-label">Remaining life expectancy</div>
            <div class="stat-value">
              <span id="le_baseline">–</span> → <span id="le_adjusted">–</span>
            </div>
            <div class="stat-delta"><span id="le_delta">+0.0</span> years</div>
          </div>

          <div class="stat" id="hale-row" hidden>
            <div class="stat-label">Healthy life expectancy</div>
            <div class="stat-value">
              <span id="hale_baseline">–</span> → <span id="hale_adjusted">–</span>
            </div>
            <div class="stat-delta"><span id="hale_delta">+0.0</span> years</div>
          </div>

          <div id="contrib" class="contrib"></div>

          <div class="actions">
            <button id="downloadCsv" type="button">Download CSV</button>
            <button id="shareState" type="button">Share</button>
          </div>

          <small class="disclaimer">
            CSV includes this disclaimer and method summary in its header rows. Interpret with caution.
          </small>
        </div>
      </div>

      <!-- Charts -->
      <div class="chart" id="survivalChart" aria-label="Survival curves baseline vs adjusted"></div>
      <div class="chart" id="cdfChart" aria-label="Cumulative probability of death by age"></div>

      <!-- Assumptions Drawer -->
      <dialog id="assumptionsModal" aria-labelledby="assumptionsTitle">
        <h3 id="assumptionsTitle">Assumptions & Data Sources</h3>
        <div id="assumptionsBody" class="assumptions-body">
          <p><strong>Method:</strong> Period U.S. life table → annual hazards; apply behavior hazard ratios multiplicatively
          (proportional hazards). Preventive screenings added as life-years/QALYs from published models. HALE via Sullivan method:
          person-years weighted by “healthy” prevalence.</p>

          <p><strong>Data files used in this app (static JSON):</strong></p>
          <ul>
            <li><code>data/lifetable_US_2022.json</code> — Period life table (qx by age/sex), adapted from U.S. NCHS 2022 life table.</li>
            <li><code>data/hr_physical_activity.json</code> — Relative risks by MET-hours/week bins from pooled cohort analysis.</li>
            <li><code>data/hr_bmi.json</code> — BMI category hazard ratios (never-smokers reference ≈ 22.5–&lt;25).</li>
            <li><code>data/hr_smoking.json</code> — Current smoker HR and former-smoker HR decay by years-since-quit.</li>
            <li><code>data/hr_alcohol.json</code> — Dose-response HR vs drinks/day, conservative (no protective effect).</li>
            <li><code>data/screening_crc.json</code>, <code>data/screening_breast.json</code> — Life-years/QALYs gained per 1,000 screened.</li>
            <li><code>data/hale_weights.json</code> — Age-specific “healthy” prevalence for Sullivan HALE.</li>
          </ul>
          <p><strong>Limits & Disclaimers:</strong> Associations ≠ causation; population averages; no comorbidity interactions; period table
          holds future mortality trends fixed; screening deltas are model-based and simplified to per-person averages. Not medical advice.</p>
          <button id="closeAssumptions" class="secondary">Close</button>
        </div>
      </dialog>
    </section>
  </main>

  <noscript>
    <div class="max-w-xl mx-auto mt-12 p-4 rounded-xl bg-white/80 border">
      Please enable JavaScript to use the Fitness Toolkit.
    </div>
  </noscript>

  <!-- React + ReactDOM UMD -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

  <!-- Babel (so you can keep using type="text/babel" locally) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Your app logic -->
  <script type="text/babel" src="script.js"></script>
</body>
</html>
<!-- partial -->
<script src='https://unpkg.com/react@18/umd/react.development.js'></script>
<script src='https://unpkg.com/react-dom@18/umd/react-dom.development.js'></script><script  src="./script.js"></script>
<script type="module" src="js/app.js"></script>

</body>
</html>
